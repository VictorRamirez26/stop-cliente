<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Ela Admin - HTML5 Admin Template</title>
    <meta name="description" content="Ela Admin - HTML5 Admin Template">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Usando Thymeleaf para manejar los iconos -->
    <link rel="apple-touch-icon" th:href="@{https://i.imgur.com/QRAUqs9.png}">
    <link rel="shortcut icon" th:href="@{https://i.imgur.com/QRAUqs9.png}">

    <!-- Usamos 'th:href' para manejar las rutas de las hojas de estilo -->
    <link rel="stylesheet" th:href="@{https://cdn.jsdelivr.net/npm/normalize.css@8.0.0/normalize.min.css}">
    <link rel="stylesheet" th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css}">
    <link rel="stylesheet" th:href="@{https://cdn.jsdelivr.net/gh/lykmapipo/themify-icons@0.1.2/css/themify-icons.css}">
    <link rel="stylesheet" th:href="@{https://cdn.jsdelivr.net/npm/pixeden-stroke-7-icon@1.2.3/pe-icon-7-stroke/dist/pe-icon-7-stroke.min.css}">
    <link rel="stylesheet" th:href="@{https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.0/css/flag-icon.min.css}">
    <link rel="stylesheet" th:href="@{/assets/css/cs-skin-elastic.css}">
    <link rel="stylesheet" th:href="@{/assets/css/style.css}">
    <link th:href="@{https://cdn.jsdelivr.net/npm/chartist@0.11.0/dist/chartist.min.css}" rel="stylesheet">
    <link th:href="@{https://cdn.jsdelivr.net/npm/jqvmap@1.5.1/dist/jqvmap.min.css}" rel="stylesheet">
    <link th:href="@{https://cdn.jsdelivr.net/npm/weathericons@2.1.0/css/weather-icons.css}" rel="stylesheet" />
    <link th:href="@{https://cdn.jsdelivr.net/npm/fullcalendar@3.9.0/dist/fullcalendar.min.css}" rel="stylesheet" />

    <style>
        #weatherWidget .currentDesc {
            color: #ffffff!important;
        }
        .traffic-chart {
            min-height: 335px;
        }
        #flotPie1  {
            height: 150px;
        }
        #flotPie1 td {
            padding:3px;
        }
        #flotPie1 table {
            top: 20px!important;
            right: -10px!important;
        }
        .chart-container {
            display: table;
            min-width: 270px ;
            text-align: left;
            padding-top: 10px;
            padding-bottom: 10px;
        }
        #flotLine5  {
             height: 105px;
        }
        #flotBarChart {
            height: 150px;
        }
        #cellPaiChart{
            height: 160px;
        }
    </style>
</head>

<body>
    <!-- LEFT PANEL-->
    <div th:replace="~{fragments/left-panel}"></div> 

    <!-- RIGHT PANEL -->
    <div id="right-panel" class="right-panel">
    
        <!-- HEADER -->
        <div th:replace="~{fragments/header :: header}"></div>
        
        <div class="content">

            <!-- FORM -->
            <div class="col-lg-10">
                <div class="card">
                    <div class="card-header">
                        <strong th:text="${accion}"></strong><strong> Servicio</strong>
                    </div>

                    <form th:object="${servicio}" method="POST" enctype="multipart/form-data">
                        <div class="card-body card-block">
                            <div th:if="${error}" class="alert alert-danger" role="alert">
                                <span th:text="${error}"></span>
                            </div>

                            <div class="form-group">
                                <input type="hidden" name="id" th:value="${servicio.id}"/>
                                <input type="hidden" name="accion" th:value="${accion}"/>

                                <label for="nombre">Nombre</label>
                                <input name="nombre" type="text" id="nombre"
                                       placeholder="Ingrese el nombre"
                                       th:value="${servicio.nombre}"
                                       class="form-control"
                                       th:disabled="${accion == 'Eliminar' OR accion == 'Consultar'}"
                                       required>
                            </div>

                            <div class="form-group">
                                <label for="imagen">Imagen</label>
                                <!-- Mostrar imagen actual si existe -->
                                <div th:if="${servicio.contenidoImagen != null}" class="mb-2">
                                    <img th:src="@{'data:' + ${servicio.mimeImagen} + ';base64,' + ${#arrays.toString(servicio.contenidoImagen)}}"
                                         alt="Imagen actual"
                                         style="max-width: 200px; max-height: 200px;"
                                         class="img-thumbnail">
                                </div>
                                <input type="file"
                                       name="imagen"
                                       id="imagen"
                                       class="form-control"
                                       accept="image/*"
                                       th:disabled="${accion == 'Eliminar' OR accion == 'Consultar'}"
                                       th:required="${servicio.id == null}">
                                <small class="form-text text-muted" th:if="${servicio.id != null}">
                                    Deja vac√≠o para mantener la imagen actual
                                </small>
                            </div>

                            <div class="mt-3">
                                <button type="submit"
                                        class="btn btn-dark"
                                        formaction="/servicio/listarServicios"
                                        formmethod="GET"
                                        formnovalidate>Volver</button>

                                <button th:if="${accion == 'Crear'}"
                                        type="submit"
                                        class="btn btn-primary"
                                        formaction="/servicio/actualizar-servicio"
                                        formmethod="POST">Crear servicio</button>

                                <button th:if="${accion == 'Modificar'}"
                                        type="submit"
                                        class="btn btn-primary"
                                        formaction="/servicio/actualizar-servicio"
                                        formmethod="POST">Modificar servicio</button>

                                <button th:if="${accion == 'Eliminar'}"
                                        type="submit"
                                        class="btn btn-danger"
                                        formaction="/servicio/eliminar-servicio"
                                        formmethod="POST">Eliminar servicio</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <!-- END FORM -->
            
        </div><!-- .content -->
    
    </div><!-- #right-panel -->
    <!-- END RIGHT PANEL -->

    <!-- Scripts -->
	<div th:replace="~{fragments/js-fragments :: scripts-comunes}"></div>

</body>
</html>
